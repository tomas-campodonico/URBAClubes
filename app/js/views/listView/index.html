<link rel="import" href="../../vendor/core-header-panel/core-header-panel.html">
<link rel="import" href="../../vendor/core-toolbar/core-toolbar.html">
<link rel="import" href="../../vendor/paper-input/paper-input.html">
<polymer-element name="club-list">
	<template>
		<style type="text/css">
			.club-list__item {
				border-bottom: solid 1px #3d3d3d;
				height: 44px;
				max-height: 44px;
				padding: 5px;
				font-size: 12px;
				overflow: hidden;
			}
			core-header-panel {
			  height: 100%;
			  overflow: auto;
			  -webkit-overflow-scrolling: touch; 
			}
			#menupanel {
			  position: static;
			}
			.club-name {
				font-weight: bold;
				font-size: 14px;
				color: #252051;
			}
			.club-address {
				height: 15px;
				max-height: 15px;
				white-space: nowrap;
			  overflow: hidden;
			  text-overflow: ellipsis;
			  color: #666666;
			}
			#searchheader {
			  font-size: 17px;
			  height: 45px;
			}

			#searchheader paper-input {
			  height: 100%;
			  margin-bottom: 15px;
			}
		</style>
		<core-header-panel flex id="menupanel">
	    <core-toolbar id="searchheader">
	      <paper-input on-keyup="{{filterList}}" label="Buscar club"></paper-input>
	    </core-toolbar>
    	<div id="club-list-container" class="club-list-container">
			  <template repeat="{{clubes}}">
			    <div class="club-list__item">
			    	<div class="club-name">{{name}}</div>
			    	<div class="club-address">{{address}}</div>
			    </div>
			  </template>
			</div>
  	</core-header-panel>
	</template>
	<script>
		Polymer({
      ready: function() {
      	var self = this;

      	//load data
        this.getJSON(function(response) {
        	self.clubes = JSON.parse(response);
        });
      },
      getJSON: function(callback) {
				var xhttp = new XMLHttpRequest(),
					url = '../../../json/clubes.json';

				xhttp.open('GET', url, true);
				xhttp.send(null);
				xhttp.onreadystatechange = function() {
					if (xhttp.status == 200 && xhttp.readyState == 4) {
						callback(xhttp.responseText);
					}
				};
			},
			filterList: function() {
				var items = this.$['club-list-container'].querySelectorAll('.club-list__item'),
					filter = this.$.searchheader.querySelector('paper-input').value.toLowerCase(),
	        name;

	      [].forEach.call(items, function(item) {
	        name = item.querySelector('.club-name').innerHTML.toLowerCase();
	        if (name.indexOf(filter) === -1) {
	          if (!item.classList.contains('hidden')) {
	            item.classList.add('hidden');
	          }
	        } else {
	          if (item.classList.contains('hidden')) {
	            item.classList.remove('hidden');
	          }
	        }
	      });
			}
    });
	</script>
</polymer-element>